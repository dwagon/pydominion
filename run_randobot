#!/usr/bin/env python
""" Run randobot tests """

import os
import sys
import random

os.chdir(os.path.normpath(os.path.join(os.path.abspath(__file__), os.pardir)))

# Now try running example games
cardsets = os.listdir("cardset")
random.shuffle(cardsets)
for cardset in cardsets:
    cs_str = f"cardset/{cardset}"
    if not os.path.isfile(cs_str):
        continue
    players = "--randobot 4 --numplayers 4"
    redirect = f"> /tmp/randobot_{cardset}.{os.getpid()} 2>&1"
    print(f"Playing with {cs_str}")
    grc = os.system(f"PYTHONPATH=. ./dominion/rungame.py --oldcards {players} --cardset {cs_str} {redirect}")
    if grc:
        print(f"Broke playing with {cs_str}")
        break

sys.exit(grc >> 8)

# EOF
